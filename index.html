<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>donnes</title>


  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css">

  <style>
    body {
      font-family: Arial, sans-serif;
     
      text-align: right;
      margin: 20px;
      background-color: #f4f4f9;
    }

    /* Table Styles */
    table {
      width: 100%;
      margin-top: 40px;
      border-collapse: collapse;
      background-color: #fff;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    table, th, td {
      border: 1px solid #ddd;
    }

    th, td {
      padding: 12px;
      text-align: left;
    }

    th {
      background-color: #3498db;
      color: #fff;
    }
  </style>

  <script>
    async function fetchD1() {
      try {
        const response = await fetch('https://script.google.com/macros/s/AKfycbx1NAGRvv1q43LxLT776_iGmlzocPsF4h6Dw6016_vOsv9EKaKBkRjPSGgwAsU5-Kx2bg/exec'); // Replace with your actual URL
        data = await response.json(); 

        populateTable(data);
      } catch (error) {
        console.error('Error fetching data:', error);
      }
    }

    function populateTable(filteredData) {
  const tableBody = document.getElementById('data-table').getElementsByTagName('tbody')[0];
  tableBody.innerHTML = '';  

  let totalQuantity = 0;
  let totalHours = 0;
  let REND = 0;

  filteredData.forEach(row => {
    const tr = document.createElement('tr');

    Object.values(row).forEach((value, index) => {
      const td = document.createElement('td');
      td.textContent = value;
      tr.appendChild(td);

      if (index === 4) REND =totalQuantity / totalHours|| 0;
      if (index === 5) totalQuantity += parseFloat(value) || 0;
      if (index === 6) totalHours += parseFloat(value) || 0;
      
    });

    tableBody.appendChild(tr);
  });


  document.getElementById('sum-quantity').textContent = `TOTAL RECOLTE: ${totalQuantity.toFixed(2)}`;
  document.getElementById('sum-hours').textContent = `TOTAL HEURES: ${totalHours.toFixed(2)}`;
  document.getElementById('REND1').textContent = `REND : ${REND.toFixed(2)} KG/H`;
}


    function applyFilters() {
  const timestampFilter = document.getElementById('filter-timestamp').value.trim().toLowerCase();
  const objectiveFilter = document.getElementById('filter-objective').value.trim().toLowerCase();
  const groupFilter = document.getElementById('filter-group').value.trim().toLowerCase();
  const nameFilter = document.getElementById('filter-name').value.trim().toLowerCase();
  const taskFilter = document.getElementById('filter-task').value.trim().toLowerCase();
  const quantityFilter = document.getElementById('filter-quantity').value.trim().toLowerCase();
  const hoursFilter = document.getElementById('filter-hours').value.trim().toLowerCase();

  const filteredData = data.filter(row => {
    return (
      (!timestampFilter || row.timestamp.toLowerCase().includes(timestampFilter)) &&
      (!objectiveFilter || row.objective.toLowerCase().includes(objectiveFilter)) &&
      (!groupFilter || row.group.toLowerCase().includes(groupFilter)) &&
      (!nameFilter || row.name.toLowerCase().includes(nameFilter)) &&
      (!taskFilter || row.task.toLowerCase().includes(taskFilter)) &&
      (!quantityFilter || row.quantity.toLowerCase().includes(quantityFilter)) &&
      (!hoursFilter || row.hours.toLowerCase().includes(hoursFilter))
    );
  });

  populateTable(filteredData);
}

    window.onload = function() {
    fetchD1();
    
};

  </script>

  <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
</head>
<table id="data-table" border="1">
  <thead>
    <tr>
      <th colspan="4"></th>
      <th id="REND1">RENDEET : 0</th>
      <th id="sum-quantity">TOTAL RECOLTE : 0</th>
      <th id="sum-hours">TOTAL HEURES : 0</th>
    </tr>
    <tr>
      <th><input type="text" id="filter-timestamp" placeholder="Filter by Timestamp" oninput="applyFilters()"></th>
      <th><input type="text" id="filter-objective" placeholder="Filter by Objective" oninput="applyFilters()"></th>
      <th><input type="text" id="filter-group" placeholder="Filter by Group" oninput="applyFilters()"></th>
      <th><input type="text" id="filter-name" placeholder="Filter by Name" oninput="applyFilters()"></th>
      <th><input type="text" id="filter-task" placeholder="Filter by Task" oninput="applyFilters()"></th>
      <th><input type="text" id="filter-quantity" placeholder="Filter by Quantity" oninput="applyFilters()"></th>
      <th><input type="text" id="filter-hours" placeholder="Filter by Estimated Hours" oninput="applyFilters()"></th>
    </tr>
    <tr>
      <th>Timestamp</th>
      <th>Objective</th>
      <th>Group</th>
      <th>Name</th>
      <th>Task</th>
      <th>Quantity (KG)</th>
      <th>Estimated Hours</th>
    </tr>
  </thead>
  <tbody>
    <!-- Data rows will be inserted here -->
  </tbody>
</table>
</body>
</html>
